{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/ivan/Metadata/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _classCallCheck = require(\"/Users/ivan/Metadata/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/ivan/Metadata/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Auth = void 0;\nvar uuid_1 = require(\"uuid\");\nvar crypto_js_1 = __importDefault(require(\"crypto-js\"));\nvar events_1 = require(\"events\");\nvar types_1 = require(\"./types\");\nvar utils_1 = require(\"./utils\");\nvar Auth = /*#__PURE__*/function () {\n  function Auth(config) {\n    var _this = this;\n    _classCallCheck(this, Auth);\n    this.config = config;\n    this.userStore = \"particle_user_info\";\n    this.events = new events_1.EventEmitter();\n    this.secretKey = \"\";\n    this._authResult = null;\n    this.uiMode = \"auto\";\n    this.displayCloseButton = true;\n    this.config = config;\n    window.addEventListener(\"message\", function (event) {\n      if (event.data.name && event.data.name === \"particle-network-provider\" && _this._authResult) {\n        var data = _this.decrypt(event.data.data);\n        if (data.token && data.uuid) {\n          _this.setUserInfo(data);\n        }\n        if (data.wallets) {\n          var userInfo = _this.userInfo();\n          if (userInfo) {\n            userInfo.wallets = data.wallets;\n            _this.setUserInfo(userInfo);\n          }\n        }\n        if (data.error) {\n          if (data.error.code === 8005 || data.error.code === 10005) {\n            _this.setUserInfo(null);\n            _this.events.emit(\"disconnect\");\n          }\n          _this._authResult.reject(data.error);\n        } else {\n          _this._authResult.resolve(data);\n        }\n        _this._authResult.iframe.remove();\n        _this._authResult = null;\n        var container = document.getElementById(\"particle-network-container\");\n        if (container) {\n          container.style.display = \"none\";\n        }\n      }\n    });\n  }\n  _createClass(Auth, [{\n    key: \"login\",\n    value: function login(config) {\n      var _this2 = this;\n      var _a;\n      var iframe = this.getIframe();\n      iframe.src = this.buildUrl(\"/login\", {\n        login_type: config === null || config === void 0 ? void 0 : config.preferredAuthType,\n        support_auth_types: (_a = config === null || config === void 0 ? void 0 : config.supportAuthTypes) !== null && _a !== void 0 ? _a : \"all\",\n        account: config === null || config === void 0 ? void 0 : config.emailOrPhoneAccount,\n        login_form_mode: config === null || config === void 0 ? void 0 : config.loginFormMode\n      });\n      return new Promise(function (_resolve, reject) {\n        _this2.setAuthResult({\n          resolve: function resolve(value) {\n            _this2.events.emit(\"connect\", value);\n            _resolve(value);\n          },\n          reject: reject,\n          iframe: iframe\n        });\n      });\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _this3 = this;\n        var iframe;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                iframe = this.getIframe();\n                iframe.src = this.buildUrl(\"/logout\");\n                return _context.abrupt(\"return\", new Promise(function (_resolve2, reject) {\n                  _this3.setAuthResult({\n                    resolve: function resolve() {\n                      _this3.setUserInfo(null);\n                      _this3.events.emit(\"disconnect\");\n                      _resolve2();\n                    },\n                    reject: reject,\n                    iframe: iframe\n                  });\n                }));\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    }\n  }, {\n    key: \"sign\",\n    value: function sign(method, message) {\n      var _a, _b;\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var _this4 = this;\n        var iframe;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.walletExist()) {\n                  _context2.next = 2;\n                  break;\n                }\n                return _context2.abrupt(\"return\", Promise.reject(types_1.AuthError.walletNotCreated()));\n              case 2:\n                iframe = this.getIframe();\n                if (this.config.chainName === \"solana\") {\n                  iframe.src = this.buildUrl(\"/solana/sign\", {\n                    token: (_a = this.userInfo()) === null || _a === void 0 ? void 0 : _a.token,\n                    method: method,\n                    chain_id: Number(this.config.chainId),\n                    message: message\n                  });\n                } else {\n                  iframe.src = this.buildUrl(\"/evm-chain/sign\", {\n                    token: (_b = this.userInfo()) === null || _b === void 0 ? void 0 : _b.token,\n                    method: method,\n                    chain_id: Number(this.config.chainId),\n                    message: message\n                  });\n                }\n                return _context2.abrupt(\"return\", new Promise(function (_resolve3, reject) {\n                  _this4.setAuthResult({\n                    resolve: function resolve(value) {\n                      var _a;\n                      _resolve3((_a = value.signature) !== null && _a !== void 0 ? _a : \"\");\n                    },\n                    reject: reject,\n                    iframe: iframe\n                  });\n                }));\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n    }\n  }, {\n    key: \"signAllTransactions\",\n    value: function signAllTransactions(messages) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var result, signatures;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this.walletExist()) {\n                  _context3.next = 2;\n                  break;\n                }\n                return _context3.abrupt(\"return\", Promise.reject(types_1.AuthError.walletNotCreated()));\n              case 2:\n                if (!(this.config.chainName !== \"solana\")) {\n                  _context3.next = 4;\n                  break;\n                }\n                return _context3.abrupt(\"return\", Promise.reject(types_1.AuthError.unsupportedMethod()));\n              case 4:\n                _context3.next = 6;\n                return this.sign(\"signAllTransactions\", JSON.stringify(messages));\n              case 6:\n                result = _context3.sent;\n                signatures = JSON.parse(result);\n                return _context3.abrupt(\"return\", signatures);\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n    }\n  }, {\n    key: \"sendTransaction\",\n    value: function sendTransaction(message) {\n      var _a;\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var _this5 = this;\n        var iframe;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (this.walletExist()) {\n                  _context4.next = 2;\n                  break;\n                }\n                return _context4.abrupt(\"return\", Promise.reject(types_1.AuthError.walletNotCreated()));\n              case 2:\n                if (!(this.config.chainName === \"solana\")) {\n                  _context4.next = 6;\n                  break;\n                }\n                return _context4.abrupt(\"return\", this.sign(\"signAndSendTransaction\", message));\n              case 6:\n                iframe = this.getIframe();\n                iframe.src = this.buildUrl(\"/evm-chain/sign\", {\n                  token: (_a = this.userInfo()) === null || _a === void 0 ? void 0 : _a.token,\n                  method: \"eth_sendTransaction\",\n                  chain_id: Number(this.config.chainId),\n                  message: message\n                });\n                return _context4.abrupt(\"return\", new Promise(function (_resolve4, reject) {\n                  _this5.setAuthResult({\n                    resolve: function resolve(value) {\n                      var _a;\n                      _resolve4((_a = value.signature) !== null && _a !== void 0 ? _a : \"\");\n                    },\n                    reject: reject,\n                    iframe: iframe\n                  });\n                }));\n              case 9:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n    }\n  }, {\n    key: \"setChainInfo\",\n    value: function setChainInfo(chain) {\n      var _this6 = this;\n      var userInfo = this.userInfo();\n      if (!userInfo) {\n        return Promise.reject(types_1.AuthError.notLogin());\n      }\n      if (typeof chain.name !== \"string\" || typeof chain.id !== \"number\") {\n        throw types_1.AuthError.paramsError();\n      }\n      if (!Object.keys(types_1.supportChains).includes(chain.name)) {\n        throw types_1.AuthError.unsupportedChain();\n      }\n      var chainName = chain.name;\n      if (!types_1.supportChains[chainName].includes(chain.id)) {\n        throw types_1.AuthError.unsupportedChain();\n      }\n      var wallets = userInfo.wallets;\n      if (this.config.chainName === chain.name && this.config.chainId === chain.id) {\n        return Promise.resolve(wallets);\n      }\n      var wallet = this.wallet(chainName === \"solana\" ? \"solana\" : \"evm_chain\");\n      if (wallet) {\n        this.config.chainName = chain.name;\n        this.config.chainId = chain.id;\n        this.events.emit(\"chainChanged\", chain);\n        return Promise.resolve(wallets);\n      }\n      //create wallet\n      var iframe = this.getIframe();\n      iframe.src = this.buildUrl(\"/wallet\", {\n        token: userInfo.token,\n        chain_name: chain.name\n      });\n      return new Promise(function (_resolve5, reject) {\n        _this6.setAuthResult({\n          resolve: function resolve(value) {\n            _this6.config.chainName = chain.name;\n            _this6.config.chainId = chain.id;\n            _this6.events.emit(\"connect\", _this6.userInfo());\n            _this6.events.emit(\"chainChanged\", chain);\n            _resolve5(value);\n          },\n          reject: reject,\n          iframe: iframe\n        });\n      });\n    }\n  }, {\n    key: \"chainId\",\n    value: function chainId() {\n      return this.config.chainId;\n    }\n  }, {\n    key: \"basicCredentials\",\n    value: function basicCredentials() {\n      return \"Basic \".concat(Buffer.from(\"\".concat(this.config.projectId, \":\").concat(this.config.clientKey), \"utf8\").toString(\"base64\"));\n    }\n  }, {\n    key: \"isLogin\",\n    value: function isLogin() {\n      return this.userInfo() !== null;\n    }\n  }, {\n    key: \"userInfo\",\n    value: function userInfo() {\n      var info = window.localStorage.getItem(this.userStore);\n      return info ? JSON.parse(info) : null;\n    }\n  }, {\n    key: \"walletExist\",\n    value: function walletExist() {\n      return this.wallet() != null;\n    }\n  }, {\n    key: \"wallet\",\n    value: function wallet(chainType) {\n      var _this7 = this;\n      var userInfo = this.userInfo();\n      if (!userInfo) {\n        return null;\n      }\n      var wallet = userInfo.wallets.find(function (wallet) {\n        return wallet.chain_name === (chainType || _this7.walletChainName());\n      });\n      if (wallet !== undefined && wallet.public_address.length > 0) {\n        return wallet;\n      }\n      return null;\n    }\n  }, {\n    key: \"setAuthTheme\",\n    value: function setAuthTheme(config) {\n      if (config.uiMode) {\n        this.uiMode = config.uiMode;\n      }\n      if (config.displayCloseButton !== null && config.displayCloseButton !== undefined) {\n        this.displayCloseButton = config.displayCloseButton;\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, listener) {\n      this.events.on(event, listener);\n    }\n  }, {\n    key: \"once\",\n    value: function once(event, listener) {\n      this.events.once(event, listener);\n    }\n  }, {\n    key: \"off\",\n    value: function off(event, listener) {\n      this.events.off(event, listener);\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(event, listener) {\n      this.events.removeListener(event, listener);\n    }\n  }, {\n    key: \"walletChainName\",\n    value: function walletChainName() {\n      return this.config.chainName === \"solana\" ? \"solana\" : \"evm_chain\";\n    }\n  }, {\n    key: \"setAuthResult\",\n    value: function setAuthResult(authResult) {\n      if (this._authResult) {\n        this._authResult.reject(types_1.AuthError.userCancelOperation());\n      }\n      this._authResult = authResult;\n    }\n  }, {\n    key: \"setUserInfo\",\n    value: function setUserInfo(info) {\n      if (info) {\n        window.localStorage.setItem(this.userStore, JSON.stringify(info));\n      } else {\n        window.localStorage.removeItem(this.userStore);\n      }\n    }\n  }, {\n    key: \"getIframe\",\n    value: function getIframe() {\n      var containerDiv = document.getElementById(\"particle-network-container\");\n      if (!containerDiv) {\n        containerDiv = document.createElement(\"div\");\n        containerDiv.setAttribute(\"style\", \"display: block;position: fixed;top: 0px;right: 0px;width: 100%;height: 100%;border-radius: 0px;border: none;z-index: 2147483647;background-color: rgba(0, 0, 0, 0.5);align-items: center;\");\n        containerDiv.id = \"particle-network-container\";\n        document.body.appendChild(containerDiv);\n      } else {\n        containerDiv.style.display = \"block\";\n      }\n      var iframe;\n      var elements = document.getElementsByName(\"particle-network-iframe\");\n      if (elements.length > 0) {\n        iframe = elements[0];\n        iframe.style.display = \"\";\n      } else {\n        iframe = document.createElement(\"iframe\");\n        iframe.name = \"particle-network-iframe\";\n        var bgColor = \"background-color: #FFFFFF\";\n        var themeType = this.getThemeType();\n        if (themeType === \"dark\") {\n          bgColor = \"background-color: #000000\";\n        }\n        iframe.setAttribute(\"style\", \"position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);width: 400px;height: 650px;border-radius: 0px;border: none;z-index: 2147483647;box-shadow: -1px 3px 11px 2px #00000073;border-radius: 10px;\" + bgColor);\n        containerDiv.appendChild(iframe);\n      }\n      return iframe;\n    }\n  }, {\n    key: \"buildUrl\",\n    value: function buildUrl(path) {\n      var extraParams = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var _a;\n      var schema = (_a = this.config.authUrl) !== null && _a !== void 0 ? _a : \"https://auth.particle.network\";\n      var params = {\n        project_uuid: this.config.projectId,\n        project_client_key: this.config.clientKey,\n        project_app_uuid: this.config.appId,\n        chain_name: this.config.chainName,\n        sdk_version: (0, utils_1.getVersion)(),\n        device_id: (0, utils_1.getDeviceId)(),\n        display_close_button: this.displayCloseButton\n      };\n      Object.assign(params, Object.assign({}, extraParams));\n      this.secretKey = (0, uuid_1.v4)().replace(/-/g, \"\").toUpperCase();\n      var keyWA = crypto_js_1.default.enc.Utf8.parse(this.secretKey);\n      var cipherText = crypto_js_1.default.AES.encrypt(JSON.stringify(params), keyWA, {\n        mode: crypto_js_1.default.mode.ECB,\n        algorithm: crypto_js_1.default.algo.AES,\n        padding: crypto_js_1.default.pad.Pkcs7,\n        formatter: crypto_js_1.default.format.Hex\n      }).ciphertext;\n      var value = encodeURIComponent(crypto_js_1.default.enc.Base64.stringify(cipherText)) + this.secretKey;\n      var url = \"\".concat(schema, \"?params=\").concat(value, \"&encoding=base64&theme_type=\").concat(this.getThemeType(), \"#\").concat(path);\n      return url;\n    }\n  }, {\n    key: \"getThemeType\",\n    value: function getThemeType() {\n      return this.uiMode === \"auto\" ? window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\" : this.uiMode;\n    }\n  }, {\n    key: \"decrypt\",\n    value: function decrypt(data) {\n      var dec = crypto_js_1.default.enc.Hex.parse(data);\n      var keyWA = crypto_js_1.default.enc.Utf8.parse(this.secretKey);\n      var bytes = crypto_js_1.default.AES.decrypt(crypto_js_1.default.lib.CipherParams.create({\n        ciphertext: dec,\n        key: keyWA,\n        algorithm: crypto_js_1.default.algo.AES,\n        padding: crypto_js_1.default.pad.Pkcs7,\n        formatter: crypto_js_1.default.format.Hex\n      }), keyWA, {\n        mode: crypto_js_1.default.mode.ECB\n      });\n      return JSON.parse(bytes.toString(crypto_js_1.default.enc.Utf8));\n    }\n  }]);\n  return Auth;\n}();\nexports.Auth = Auth;","map":{"version":3,"mappings":"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","names":["Auth","config","events_1","window","addEventListener","event","data","name","_authResult","decrypt","token","uuid","setUserInfo","wallets","userInfo","error","code","events","emit","reject","resolve","iframe","remove","container","document","getElementById","style","display","getIframe","src","buildUrl","login_type","preferredAuthType","support_auth_types","supportAuthTypes","account","emailOrPhoneAccount","login_form_mode","loginFormMode","Promise","setAuthResult","value","method","message","walletExist","types_1","walletNotCreated","chainName","chain_id","Number","chainId","signature","messages","unsupportedMethod","sign","JSON","stringify","result","signatures","parse","chain","notLogin","id","paramsError","Object","keys","includes","unsupportedChain","wallet","chain_name","Buffer","from","projectId","clientKey","toString","info","localStorage","getItem","userStore","chainType","find","walletChainName","undefined","public_address","length","uiMode","displayCloseButton","listener","on","once","off","removeListener","authResult","userCancelOperation","setItem","removeItem","containerDiv","createElement","setAttribute","body","appendChild","elements","getElementsByName","bgColor","themeType","getThemeType","path","extraParams","schema","authUrl","params","project_uuid","project_client_key","project_app_uuid","appId","sdk_version","device_id","display_close_button","assign","secretKey","replace","toUpperCase","keyWA","crypto_js_1","enc","Utf8","cipherText","AES","encrypt","mode","ECB","algorithm","algo","padding","pad","Pkcs7","formatter","format","Hex","ciphertext","encodeURIComponent","Base64","url","matchMedia","matches","dec","bytes","lib","CipherParams","create","key","exports"],"sources":["../src/auth.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}