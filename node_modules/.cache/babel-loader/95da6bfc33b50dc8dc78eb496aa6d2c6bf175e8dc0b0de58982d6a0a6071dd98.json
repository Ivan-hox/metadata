{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/ivan/Metadata/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/Users/ivan/Metadata/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/ivan/Metadata/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nexport var Connection = /*#__PURE__*/function () {\n  function Connection(validatedOrigin, targetWindow) {\n    _classCallCheck(this, Connection);\n    this.validatedOrigin = validatedOrigin;\n    this.targetWindow = targetWindow;\n    this.handlers = new Map();\n  }\n  _createClass(Connection, [{\n    key: \"off\",\n    value: function off(event, callback) {\n      var eventCallbacks = this.handlers.get(event);\n      eventCallbacks === null || eventCallbacks === void 0 ? void 0 : eventCallbacks.delete(callback);\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, callback) {\n      var _a;\n      var eventCallbacks = (_a = this.handlers.get(event)) !== null && _a !== void 0 ? _a : new Set();\n      eventCallbacks.add(callback);\n      this.handlers.set(event, eventCallbacks);\n    }\n  }, {\n    key: \"send\",\n    value: function send(_ref) {\n      var event = _ref.event,\n        payload = _ref.payload;\n      this.targetWindow.postMessage({\n        event: event,\n        payload: payload\n      }, this.validatedOrigin);\n    }\n  }, {\n    key: \"runHandlersForEvent\",\n    value: function runHandlersForEvent(event, payload) {\n      var eventCallbacks = this.handlers.get(event);\n      if (!eventCallbacks) {\n        return;\n      }\n      var _iterator = _createForOfIteratorHelper(eventCallbacks),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var callback = _step.value;\n          callback(payload);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"resetHandlers\",\n    value: function resetHandlers() {\n      this.handlers.clear();\n    }\n  }, {\n    key: \"export\",\n    value: function _export() {\n      return {\n        off: this.off.bind(this),\n        on: this.on.bind(this),\n        send: this.send.bind(this),\n        validatedOrigin: this.validatedOrigin\n      };\n    }\n  }]);\n  return Connection;\n}();","map":{"version":3,"mappings":";;;AASA,WAAaA,UAAU;EAGrB,oBACWC,eAAuB,EACvBC,YAAoB;IAAA;IADpB,oBAAe,GAAfD,eAAe;IACf,iBAAY,GAAZC,YAAY;IAJN,aAAQ,GAAG,IAAIC,GAAG,EAAkC;EAKlE;EAAC;IAAA;IAAA,OAEJ,aAAIC,KAAiB,EAAEC,QAAuB;MAC5C,IAAMC,cAAc,GAAG,IAAI,CAACC,QAAQ,CAACC,GAAG,CAACJ,KAAK,CAAC;MAC/CE,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEG,MAAM,CAACJ,QAAQ,CAAC;IAClC;EAAC;IAAA;IAAA,OAED,YAAGD,KAAiB,EAAEC,QAAuB;;MAC3C,IAAMC,cAAc,GAAG,UAAI,CAACC,QAAQ,CAACC,GAAG,CAACJ,KAAK,CAAC,mCAAI,IAAIM,GAAG,EAAiB;MAC3EJ,cAAc,CAACK,GAAG,CAACN,QAAQ,CAAC;MAC5B,IAAI,CAACE,QAAQ,CAACK,GAAG,CAACR,KAAK,EAAEE,cAAc,CAAC;IAC1C;EAAC;IAAA;IAAA,OAED,oBAA+D;MAAA,IAAxDF,KAAK,QAALA,KAAK;QAAES,OAAO,QAAPA,OAAO;MACnB,IAAI,CAACX,YAAY,CAACY,WAAW,CAC3B;QACEV,KAAK,EAALA,KAAK;QACLS,OAAO,EAAPA;OACD,EACD,IAAI,CAACZ,eAAe,CACrB;IACH;EAAC;IAAA;IAAA,OAED,6BAAoBG,KAAiB,EAAES,OAAgB;MACrD,IAAMP,cAAc,GAAG,IAAI,CAACC,QAAQ,CAACC,GAAG,CAACJ,KAAK,CAAC;MAC/C,IAAI,CAACE,cAAc,EAAE;QACnB;;MACD,2CACsBA,cAAc;QAAA;MAAA;QAArC,oDAAuC;UAAA,IAA5BD,QAAQ;UACjBA,QAAQ,CAACQ,OAAO,CAAC;;MAClB;QAAA;MAAA;QAAA;MAAA;IACH;EAAC;IAAA;IAAA,OAED,yBAAa;MACX,IAAI,CAACN,QAAQ,CAACQ,KAAK,EAAE;IACvB;EAAC;IAAA;IAAA,OAED,mBAAM;MACJ,OAAO;QACLC,GAAG,EAAE,IAAI,CAACA,GAAG,CAACC,IAAI,CAAC,IAAI,CAAC;QACxBC,EAAE,EAAE,IAAI,CAACA,EAAE,CAACD,IAAI,CAAC,IAAI,CAAC;QACtBE,IAAI,EAAE,IAAI,CAACA,IAAI,CAACF,IAAI,CAAC,IAAI,CAAC;QAC1BhB,eAAe,EAAE,IAAI,CAACA;OACvB;IACH;EAAC;EAAA;AAAA","names":["Connection","validatedOrigin","targetWindow","Map","event","callback","eventCallbacks","handlers","get","delete","Set","add","set","payload","postMessage","clear","off","bind","on","send"],"sources":["../../../src/core/connection.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}